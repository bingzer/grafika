<!DOCTYPE html>
<html>
<head>
<title>Grafika</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
*{width:100%;height:100%;margin:0;padding:0}body{overflow:hidden}#grafika-canvas{display:block}
</style>
</head>
<body onload="load()" onresize="load()">
<canvas id="grafika-canvas" class="hidden"></canvas>
<script type="text/javascript">
var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},Grafika=function(){function a(){var b=this;this.animation={},this.selectedGraphics=[],this.isMovingGraphics=!1,this.options={backgroundColor:"#ffffff",foregroundColor:"#000000",brushSize:2,graphic:"freeform",graphicFill:!1,useCarbonCopy:!0,useNavigationText:!0,debugMode:!0,drawingMode:"none",loop:!1},this.callback={on:function(a,c){return b.log("[callback] "+a,c)}},this.plugins=[],this.renderers=[],this.version=a.VERSION}return a.prototype.initialize=function(b,c,d){var e=this;this.canvas=this.validateCanvas(b),this.renderers.push(this.animRenderer=new a.AnimationRenderer(this)),this.renderers.push(this.frameRenderer=new a.FrameRenderer(this)),this.renderers.push(this.layerRenderer=new a.LayerRenderer(this)),this.renderers.push(new a.Renderers.RectangleRenderer(this)),this.renderers.push(new a.Renderers.SquareRenderer(this)),this.renderers.push(new a.Renderers.CircleRenderer(this)),this.renderers.push(new a.Renderers.OvalRenderer(this)),this.renderers.push(new a.Renderers.FreeformRenderer(this)),this.renderers.push(new a.Renderers.LineRenderer(this)),this.renderers.push(new a.Renderers.TriangleRenderer(this)),this.renderers.push(new a.Renderers.LineRenderer(this)),this.renderers.push(new a.Renderers.TextRenderer(this)),this.setAnimation(d),this.setOptions(c),a.Plugins&&a.Plugins.forEach(function(a){var b=a(e);e.log("Plugin: "+b.name+" v."+(b.version||"{unknown}")),e.plugins.push(b)}),this.log("Grafika v."+this.version+" [initialized]",this),this.callback.on("initialized")},a.prototype.destroy=function(){this.selectedGraphics=[],this.isPlaying()&&this.pause(),this.clearCanvas(),this.clear(),this.setAnimation(this.animRenderer.create()),this.refresh(),this.callback.on("destroyed")},a.prototype.getAnimation=function(){return this.animation},a.prototype.setAnimation=function(a){if(a){if(!a.name)throw new Error("Animation name is required");if(!a.width||!a.height)throw new Error("Animation width + height is required");"undefined"!=typeof a.frames&&0!=a.frames.length||(a.frames=[this.frameRenderer.create()])}else a={};this.animation=this.animRenderer.create(a),this.log("Animation ("+this.animation.localId+") name: "+this.animation.name+", timer: "+this.animation.timer+", size: "+this.animation.width+" x "+this.animation.height+", frames: "+this.animation.frames.length+" frames"),this.canvas.setAttribute("width",""+this.animation.width),this.canvas.setAttribute("height",""+this.animation.height),this.setFrames(this.animation.frames)},a.prototype.saveAnimation=function(a){if(a){var b=this.animation.frames;this.animation=a,this.animation.frames=b}this.animation.totalFrame=this.animation.frames.length,this.animation.modified=!1,this.animation.dateModified=Date.now(),this.animation.client={navigator:navigator},this.callback.on("animationSaved")},a.prototype.play=function(){var a=this;this.animator||(this.animation.timer||(this.animation.timer=500),this.log("Animation started. Timer: "+this.animation.timer+"ms",this.animation),this.animator=window.setInterval(function(){if(a.animation.currentFrame>=a.animation.frames.length-1){if(!a.options.loop)return a.pause();a.animation.currentFrame=0}else a.navigateTo(a.animation.currentFrame+1,!1)},this.animation.timer),this.callback.on("frameCount",this.animation.frames.length),this.callback.on("playing",!0),this.navigateToFrame(0))},a.prototype.pause=function(){"undefined"!=typeof this.animator&&(window.clearInterval(this.animator),this.animator=null,this.callback.on("playing",!1),this.log("Animation stopped"))},a.prototype.isPlaying=function(){return null!=this.animator},a.prototype.isModified=function(){return this.animation.modified?!0:!!this.frame.modified},a.prototype.save=function(){this.saveAnimation(),this.saveFrame()},a.prototype.getFrame=function(){return this.frame},a.prototype.getFrames=function(){return this.animation.frames},a.prototype.setFrames=function(a){this.animation.frames=a,this.frame=this.animation.frames[0],this.navigateToFrame(0),this.callback.on("frameCount",this.animation.totalFrame)},a.prototype.saveFrame=function(){this.frame.modified=!1,this.animation.frames[this.animation.currentFrame]=this.frame,this.callback.on("frameSaved",this.animation.currentFrame)},a.prototype.nextFrame=function(){this.navigateToFrame(this.animation.currentFrame+1)},a.prototype.previousFrame=function(){this.navigateToFrame(this.animation.currentFrame-1)},a.prototype.navigateToFrame=function(a){this.navigateTo(a,!0)},a.prototype.findSelectedGraphics=function(a,b){this.selectedGraphics=[];for(var c=0;c<this.frame.layers.length;c++)for(var d=this.frame.layers[c],e=0;e<d.graphics.length;e++){var f=d.graphics[e];if(this.getGraphicRenderer(f).contains(f,a,b))return this.selectedGraphics.push(f),this.selectedGraphics}return this.selectedGraphics},a.prototype.getSelectedGraphics=function(){return this.selectedGraphics},a.prototype.deleteSelectedGraphics=function(){this.frame.modified=!0;for(var a=[],b=this.frame.layers[0].graphics,c=0;c<b.length;c++){for(var d=!1,e=0;e<this.selectedGraphics.length&&(b[c].id!=this.selectedGraphics[e].id||!(d=!0));e++);d||a.push(b[c])}this.frame.layers[0].graphics=a,this.selectedGraphics=[],this.refresh()},a.prototype.getCurrentGraphic=function(){return this.currentGraphic},a.prototype.getOptions=function(){return this.options},a.prototype.getCanvas=function(){return this.canvas},a.prototype.getCanvasContext=function(){return this.context},a.prototype.setCallback=function(a){if(!a)throw new Error("callback cannot be undefined");this.callback=a},a.prototype.setOptions=function(b){if(b){if(b.backgroundColor&&(this.options.backgroundColor=b.backgroundColor,this.frame.backgroundColor=this.options.backgroundColor,this.frame.modified=!0,this.refresh()),b.foregroundColor&&(this.options.foregroundColor=b.foregroundColor,this.frame.foregroundColor=this.options.foregroundColor,this.refresh()),b.brushSize&&(this.options.brushSize=b.brushSize),b.graphic&&(this.options.graphic=b.graphic,this.refresh()),"undefined"!=typeof b.graphicFill&&null!=b.graphicFill&&(this.options.graphicFill=b.graphicFill,this.refresh()),"undefined"!=typeof b.useCarbonCopy&&null!=b.useCarbonCopy&&(this.options.useCarbonCopy=b.useCarbonCopy,this.refresh()),"undefined"!=typeof b.useNavigationText&&null!=b.useNavigationText&&(this.options.useNavigationText=b.useNavigationText,this.refresh()),"undefined"!=typeof b.loop&&null!=b.loop&&(this.options.loop=b.loop),b.drawingMode){var c=b.drawingMode.toLowerCase();if(c!=a.MODE_NONE&&c!=a.MODE_PAINT&&c!=a.MODE_MOVE&&c!=a.MODE_SELECT&&c!=a.MODE_DELETE)throw new Error("Drawing mode is not supported: "+c);this.options.drawingMode=c,this.options.drawingMode!=a.MODE_PAINT&&this.options.drawingMode!=a.MODE_NONE||this.refresh(),this.options.drawingMode==a.MODE_DELETE&&(this.deleteSelectedGraphics(),this.refresh())}"undefined"!=typeof b.debugMode&&null!=b.debugMode&&(this.options.debugMode=b.debugMode),this.log("Options: ",this.options)}},a.prototype.refresh=function(){return this.currentGraphic=null,this.setFrame(this.frame,!0)},a.prototype.clear=function(){this.frame=this.frameRenderer.create(),this.refresh()},a.prototype.getRenderer=function(a){for(var b=0;b<this.renderers.length;b++)if(this.renderers[b].canRender(a))return this.renderers[b];throw new Error("No renderer found for "+a)},a.prototype.getGraphicRenderer=function(a){return this.getRenderer(a)},a.prototype.log=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];if(this.options.debugMode&&0!=arguments.length){for(var c=[],d=1;d<arguments.length;d++)c.push(arguments[d]);0==c.length&&(c="")}},a.prototype.validateCanvas=function(a){var b=this;if(!a)throw new Error("canvasId is required");if(this.canvas=document.querySelector(a)||document.getElementById(a),!this.canvas)throw new Error("No element found for "+a+".");return this.canvas.isPainting=!1,this.canvas.addEventListener("mousedown",function(a){return b.onMouseDown(a)}),this.canvas.addEventListener("touchstart",function(a){return b.onMouseDown(a)}),this.canvas.addEventListener("mousemove",function(a){return b.onMouseMove(a)}),this.canvas.addEventListener("touchmove",function(a){return b.onMouseMove(a)}),this.canvas.addEventListener("mouseup",function(a){return b.onMouseUp(a)}),this.canvas.addEventListener("touchend",function(a){return b.onMouseUp(a)}),this.canvas.addEventListener("mouseleave",function(a){return b.onMouseUp(a)}),this.canvas.addEventListener("touchleave",function(a){return b.onMouseUp(a)}),this.context=this.canvas.getContext("2d"),this.context.setLineDash||(this.log("LineDash: is not available!"),this.context.setLineDash=function(){}),this.canvas},a.prototype.navigateTo=function(a,b){0>=a&&(a=0),b&&this.saveFrame(),this.animation.currentFrame=a,this.frame=this.animation.frames[this.animation.currentFrame],this.frame||(this.frame=this.frameRenderer.create()),b&&this.saveFrame(),this.setFrame(this.frame,!0),this.callback.on("frameChanged",this.frame.index),this.log("Current Frame: "+(this.animation.currentFrame+1)+"/"+this.animation.frames.length,this.frame)},a.prototype.setFrame=function(a,b){var c=this;if(a)if(!b&&a&&a.id==this.frame.id||(this.clearCanvas(),this.selectedGraphics=[],this.frame=a),this.context.rect(-2,-2,parseInt(this.canvas.getAttribute("width"))+2,parseInt(this.canvas.getAttribute("height"))+2),this.context.fillStyle=this.frame.backgroundColor,this.context.fill(),this.options.useNavigationText&&(this.context.fillStyle="gray",this.context.font="25px verdana",this.context.fontWeight="bold",this.context.fillText(this.animation.currentFrame+1+" / "+this.animation.frames.length,15,40)),this.frame.backgroundResourceId){var d=new Image;d.onload=function(){c.context.drawImage(d,0,0,parseInt(c.canvas.getAttribute("width")),parseInt(c.canvas.getAttribute("height"))),c.frameRenderer.draw(c.frame)},d.onerror=function(a){c.frameRenderer.draw(c.frame)},d.crossOrigin="use-credentials",!d.src}else this.frameRenderer.draw(this.frame)},a.prototype.onMouseDown=function(b){if(b&&!this.isPlaying()&&(navigator.userAgent.match(/Android/i)&&b.preventDefault(),("mousedown"!==b.type||1==b.which)&&!this.isPlaying())){var c=b.offsetX,d=b.offsetY;if(b.changedTouches&&(c=b.changedTouches[0].pageX,d=b.changedTouches[0].pageY),this.options.drawingMode==a.MODE_MOVE&&this.selectedGraphics.length>0)return void(this.isMovingGraphics=!0);if(this.options.drawingMode==a.MODE_SELECT){var e=this.findSelectedGraphics(c,d);if(e.length>0)return this.selectedGraphics=[],this.redraw(),this.selectedGraphics=e,void this.redraw();this.selectedGraphics=[],this.redraw()}if(this.options.drawingMode==a.MODE_PAINT){var f=this.getGraphicRenderer(this.options.graphic);this.canvas.isPainting=this.options.drawingMode==a.MODE_PAINT,this.currentGraphic=f.create(),this.currentGraphic.isFilled=this.options.graphicFill,this.currentGraphic.x=c,this.currentGraphic.y=d,this.currentGraphic.brushSize=this.options.brushSize,this.currentGraphic.backgroundColor=this.options.backgroundColor,this.currentGraphic.foregroundColor=this.options.foregroundColor,f.invoke(this.currentGraphic,"mousedown",c,d)}}},a.prototype.onMouseMove=function(a){if(a&&!this.isPlaying()){var b=a.offsetX,c=a.offsetY;if(!b||!c){if(!a.changedTouches)return;b=a.changedTouches[0].pageX,c=a.changedTouches[0].pageY}if(this.isMovingGraphics&&this.selectedGraphics.length>0){this.lastX||(this.lastX=b),this.lastY||(this.lastY=c);for(var d=0;d<this.selectedGraphics.length;d++)this.getGraphicRenderer(this.selectedGraphics[d]).move(this.selectedGraphics[d],b,c,this.lastX,this.lastY);return this.lastX=b,this.lastY=c,this.clearCanvas(),void this.redraw()}this.canvas.isPainting&&this.currentGraphic&&(this.getGraphicRenderer(this.currentGraphic).invoke(this.currentGraphic,"mousemove",b,c),this.redraw())}},a.prototype.onMouseUp=function(a){if(a&&!this.isPlaying()){var b=a.offsetX,c=a.offsetY;if(!b||!c){if(!a.changedTouches)return;b=a.changedTouches[0].pageX,c=a.changedTouches[0].pageY}if(this.isPlaying()&&"mouseup"==a.type)return void this.pause();if(this.isMovingGraphics)return this.isMovingGraphics=!1,this.callback.on("frameUpdated",this.frame.index),this.lastX=null,this.lastY=null,this.clearCanvas(),void this.redraw();if(this.canvas.isPainting){var d=this.getGraphicRenderer(this.currentGraphic);d.invoke(this.currentGraphic,"mouseup",b,c),this.currentGraphic&&d.isValid(this.currentGraphic)&&(this.frame.layers[0].graphics.push(this.currentGraphic),this.frame.modified=!0,this.callback.on("frameUpdated",this.frame.index)),this.refresh(),this.canvas.isPainting=!1}}},a.prototype.clearCanvas=function(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height),this.context.rect(-2,-2,parseInt(this.canvas.getAttribute("width"))+2,parseInt(this.canvas.getAttribute("height"))+2),this.context.fillStyle="#ffffff",this.context.fill()},a.prototype.redraw=function(){return this.setFrame(this.frame)},a.randomUid=function(){return("000000"+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6)},a.hexToRgb=function(a){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(b,function(a,b,c,d){return b+b+c+c+d+d});var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return c?{r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16)}:{r:0,g:0,b:0}},a}(),Grafika;!function(a){a.Plugins=[],a.VERSION="0.12.1",a.MODE_NONE="none",a.MODE_PAINT="paint",a.MODE_MOVE="move",a.MODE_SELECT="select",a.MODE_DELETE="delete",function(a){a[a.None=0]="None",a[a.Paint=1]="Paint",a[a.Move=2]="Move",a[a.Select=3]="Select",a[a.Delete=4]="Delete"}(a.DrawingMode||(a.DrawingMode={}));a.DrawingMode;!function(a){a[a.Initialized=0]="Initialized",a[a.FrameChanged=1]="FrameChanged",a[a.FrameUpdated=2]="FrameUpdated",a[a.Destroyed=3]="Destroyed"}(a.Events||(a.Events={}));var b=(a.Events,function(){function a(){}return a}());a.Animation=b;var c=function(){function a(a){this.grafika=a,this.canvas=a.getCanvas(),this.context=a.getCanvasContext()}return a.prototype.canRender=function(a){return a&&a.type===this.getRenderingType()||a===this.getRenderingType()},a}();a.Renderer=c;var d=function(b){function c(){b.apply(this,arguments)}return __extends(c,b),c.prototype.create=function(b){return b||(b={}),b._id=b._id,b.localId=b.localId||a.randomUid(),b.name=b.name||b.localId,b.description=b.description||b.description,b.timer=b.timer||500,b.width=b.width||window.innerWidth,b.height=b.height||window.innerHeight,b.dateCreated=b.dateCreated||Date.now(),b.dateModified=b.dateModified||b.dateCreated,b.views=b.views||0,b.rating=b.rating||0,b.category=b.category||b.category,b.isPublic=b.isPublic||b.isPublic,b.author=b.author||b.author,b.userId=b.userId||b.userId,b.thumbnailUrl=b.thumbnailUrl||b.thumbnailUrl,b.frames=b.frames||[this.grafika.getRenderer("frame").create()],b.totalFrame=b.totalFrame||0,b.currentFrame=b.currentFrame||0,b.modified=b.modified||!1,b},c.prototype.draw=function(a){throw new Error},c.prototype.getRenderingType=function(){return"animation"},c}(c);a.AnimationRenderer=d;var e=function(b){function c(){b.apply(this,arguments)}return __extends(c,b),c.prototype.create=function(b){return b||(b={type:"frame"}),b.id=b.id||a.randomUid(),b.index=b.index>=0?b.index:this.grafika.getAnimation().currentFrame||0,b.modified=b.modified||!1,b.backgroundResourceId=b.backgroundResourceId||void 0,b.backgroundColor=b.backgroundColor||this.grafika.getOptions().backgroundColor,b.foregroundColor=b.foregroundColor||this.grafika.getOptions().foregroundColor,b.layers=b.layers||[this.grafika.getRenderer("layer").create()],b.type="frame",b},c.prototype.draw=function(a,b){for(var c=this.grafika.getSelectedGraphics(),d=this.grafika.getAnimation(),e=this.grafika.getOptions(),f=this.grafika.getCurrentGraphic(),g=this.grafika.getRenderer("layer"),h=0;h<c.length;h++){var i=c[h],j=this.grafika.getGraphicRenderer(i),k=j.getBounds(i),l=i.brushSize/2;this.context.lineWidth=2,this.context.setLineDash([2,4]),"#000000"!=a.backgroundColor?this.context.strokeStyle="rgba(0, 0, 0, 0.5)":this.context.strokeStyle="rgba(255, 255, 255, 0.6)",this.context.strokeRect(k.x-l-2,k.y-l-2,k.width+2*l+4,k.height+2*l+4)}if(e.useCarbonCopy&&d.currentFrame>0){var m=d.frames[d.currentFrame-1];if(m)for(var n=0;n<m.layers.length;n++)g.draw(m.layers[n],{useCarbonCopy:!0})}for(var h=0;h<a.layers.length;h++)g.draw(a.layers[h]);if(f){var j=this.grafika.getGraphicRenderer(f);j.draw(f)}},c.prototype.getRenderingType=function(){return"frame"},c}(c);a.FrameRenderer=e;var f=function(b){function c(a){b.call(this,a)}return __extends(c,b),c.prototype.create=function(b){return b||(b={type:"layer"}),b.id=b.id||a.randomUid(),b.index=b.index||0,b.graphics=b.graphics||[],b},c.prototype.draw=function(b,c){var d;this.context.setLineDash([]),this.context.lineJoin="round",this.context.lineCap="round";for(var e=0;e<b.graphics.length;e++){if(d=b.graphics[e],c&&c.useCarbonCopy){var f=a.hexToRgb(d.foregroundColor);d.foregroundAlpha="rgba("+f.r+","+f.g+","+f.b+", 0.2)"}this.grafika.getGraphicRenderer(d).draw(d),delete d.foregroundAlpha}},c.prototype.getRenderingType=function(){return"layer"},c}(c);a.LayerRenderer=f;var g;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.prototype.create=function(a){return a||(a={type:this.getRenderingType()}),a.id=a.id||("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4),a.x=a.x||0,a.y=a.y||0,a.width=a.width||10,a.height=a.height||10,a.backgroundColor=a.backgroundColor||"#ffffff",a.foregroundColor=a.foregroundColor||"#000000",a.foregroundAlpha=a.foregroundAlpha||void 0,a.isFilled="undefined"!=typeof a.isFilled&&null!=a.isFilled?a.isFilled:!1,a.isVisible="undefined"!=typeof a.isVisible&&null!=a.isVisible?a.isVisible:!0,a.brushSize=a.brushSize||2,a.type=a.type||void 0,a},b.prototype.draw=function(a){this.context.lineWidth=a.brushSize>1?a.brushSize:1,this.context.strokeStyle=a.foregroundAlpha||a.foregroundColor,this.context.fillStyle=a.foregroundAlpha||a.foregroundColor,this.onDraw(a)},b.prototype.move=function(a,b,c,d,e){this.onMove(a,b,c,d,e)},b.prototype.invoke=function(a,b,c,d){this.onEvent(a,b,c,d)},b}(c);a.GraphicRenderer=b;var d=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.getBounds=function(a){return{x:a.width>0?a.x:a.x+a.width,y:a.height>0?a.y:a.y+a.height,width:Math.abs(a.width),height:Math.abs(a.height)}},b.prototype.contains=function(a,b,c){var d=this.getBounds(a);return d.x<b&&d.x+d.width>b&&d.y<c&&d.y+d.height>c},b.prototype.isValid=function(a){return Math.abs(a.width)>20&&Math.abs(a.height)>20},b}(b);a.ShapeRenderer=d;var e=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.create=function(b){return b=a.prototype.create.call(this,b),b.points=b.points||[],b},b.prototype.getBounds=function(a){for(var b={x:a.x,y:a.y,width:a.x,height:a.y},c=0;c<a.points.length;c++){var d=a.points[c];b.x>d.x&&(b.x=d.x),b.y>d.y&&(b.y=d.y),b.width<d.x&&(b.width=d.x),b.height<d.y&&(b.height=d.y)}return b.width=b.width-b.x,b.height=b.height-b.y,b},b.prototype.isValid=function(a){var b=this.getBounds(a);return b.width>5||b.height>5},b.prototype.onDraw=function(a){this.context.beginPath(),this.context.moveTo(a.x,a.y);for(var b=0;b<a.points.length;b++){var c=a.points[b];this.context.lineTo(c.x,c.y)}a.isFilled?this.context.fill():this.context.stroke()},b.prototype.onMove=function(a,b,c,d,e){var f=a.x,g=a.y;a.x=a.x+(b-d),a.y=a.y+(c-e);for(var h=f-a.x,i=g-a.y,j=0;j<a.points.length;j++)a.points[j].x-=h,a.points[j].y-=i},b.prototype.onEvent=function(a,b,c,d){switch(b){case"mousemove":a.points.push({x:c,y:d})}},b.prototype.getRenderingType=function(){return"freeform"},b}(d);a.FreeformRenderer=e;var f=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.create=function(b){return b=a.prototype.create.call(this,b),b.endX=b.endX||b.x,b.endY=b.endY||b.y,b},b.prototype.getBounds=function(a){return{x:a.x<a.endX?a.x:a.endX,y:a.y<a.endY?a.y:a.endY,width:a.x>a.endX?a.x-a.endX:a.endX-a.x,height:a.y>a.endY?a.y-a.endY:a.endY-a.y}},b.prototype.isValid=function(a){return Math.abs(a.endX-a.x)>20||Math.abs(a.endY-a.y)>20},b.prototype.onDraw=function(a){this.context.moveTo(a.x,a.y),this.context.lineTo(a.endX,a.endY),this.context.stroke()},b.prototype.onMove=function(a,b,c,d,e){a.x=a.x+(b-d),a.y=a.y+(c-e),a.endX=a.endX+(b-d),a.endY=a.endY+(c-e)},b.prototype.onEvent=function(a,b,c,d){switch(b){case"mousemove":a.endX=c,a.endY=d}},b.prototype.getRenderingType=function(){return"line"},b}(d);a.LineRenderer=f;var g=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.onDraw=function(a){a.isFilled?this.context.fillRect(a.x,a.y,a.width,a.height):this.context.strokeRect(a.x,a.y,a.width,a.height)},b.prototype.onMove=function(a,b,c,d,e){a.x=a.x+(b-d),a.y=a.y+(c-e)},b.prototype.onEvent=function(a,b,c,d){switch(b){case"mousemove":a.width=c-a.x,a.height=d-a.y}},b.prototype.getRenderingType=function(){return"rectangle"},b}(d);a.RectangleRenderer=g;var h=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.onEvent=function(a,b,c,d){switch(b){case"mousemove":a.width=c-a.x,a.height=d-a.y,a.width=a.width>a.height?a.height:a.width,a.height=a.width>a.height?a.height:a.width}},b.prototype.getRenderingType=function(){return"square"},b}(g);a.SquareRenderer=h;var i=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.create=function(b){return b=a.prototype.create.call(this,b),b.radius=b.radius||10,b},b.prototype.getBounds=function(a){return{x:a.x-a.radius,y:a.y-a.radius,width:2*a.radius,height:2*a.radius}},b.prototype.isValid=function(a){return a.radius>5},b.prototype.onDraw=function(a){this.context.beginPath(),this.context.arc(a.x,a.y,a.radius,0,2*Math.PI),a.isFilled?this.context.fill():this.context.stroke()},b.prototype.onEvent=function(a,b,c,d){switch(b){case"mousemove":a.radius=Math.abs(c-a.x)}},b.prototype.getRenderingType=function(){return"circle"},b}(g);a.CircleRenderer=i;var j=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.create=function(b){return b=a.prototype.create.call(this,b),b.radiusY=b.radiusY||5,b},b.prototype.getBounds=function(a){return{x:a.x-a.radius,y:a.y-a.radiusY,width:2*a.radius,height:2*a.radiusY}},b.prototype.isValid=function(a){return a.radius>10&&a.radiusY>10},b.prototype.onDraw=function(a){this.context.beginPath(),this.context.ellipse(a.x,a.y,a.radius,a.radiusY,0,0,2*Math.PI),a.isFilled?this.context.fill():this.context.stroke()},b.prototype.onEvent=function(a,b,c,d){switch(b){case"mousemove":a.radius=Math.abs(c-a.x),a.radiusY=Math.abs(d-a.y)}},b.prototype.getRenderingType=function(){return"oval"},b}(i);a.OvalRenderer=j;var k=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.onDraw=function(a){this.context.beginPath(),this.context.moveTo(a.x+a.width/2,a.y),this.context.lineTo(a.x,a.y+a.height),this.context.lineTo(a.x+a.width,a.y+a.height),this.context.closePath(),a.isFilled?this.context.fill():this.context.stroke()},b.prototype.getRenderingType=function(){return"triangle"},b}(g);a.TriangleRenderer=k;var l=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.create=function(b){return b||(b={isFilled:!0,height:25}),b=a.prototype.create.call(this,b),b.text=b.text||"",b.font=b.font||"verdana",b.fontWeight=b.fontWeight||"normal",b},b.prototype.isValid=function(a){return a.text&&a.text.length>0},b.prototype.onDraw=function(a){this.context.font=a.height+"px "+a.font,a.isFilled?(this.context.fillStyle=a.foregroundAlpha||a.foregroundColor,this.context.fillText(a.text,a.x,a.y+a.height)):(this.context.strokeStyle=a.foregroundAlpha||a.foregroundColor,this.context.strokeText(a.text,a.x,a.y+a.height))},b.prototype.onEvent=function(a,b,c,d){switch(b){case"mouseup":a.text=this.prompt("Insert text"),this.drawFocusRectangle(a),this.draw(a)}},b.prototype.drawFocusRectangle=function(a){var b=this.context.measureText(a.text);a.width=b.width,this.context.lineWidth=1,this.context.setLineDash([2,4]),this.context.strokeStyle=a.foregroundColor,this.context.rect(a.x,a.y,a.width,a.height)},b.prototype.prompt=function(a,b){return window.prompt(a,b)},b.prototype.getRenderingType=function(){return"text"},b}(g);a.TextRenderer=l}(g=a.Renderers||(a.Renderers={}))}(Grafika||(Grafika={}));
//# sourceMappingURL=grafika.js.map

//@import: animation

//@import: frames

var ready = false;
function load(){
	if (document.body.clientWidth == 0 || document.body.clientHeight == 0){
		console.log("not ready...");
	}
	else {
		if (!ready) {
			if (!animation.frames)
				animation.frames = frames;		
			ready = true;
			window.grafika = new Grafika();
			window.grafika.initialize('#grafika-canvas', { debugMode: true, drawingMode: 'paint', useNavigationText: false, useCarbonCopy: false}, animation);
			window.grafika.play();
		}
	}
}
</script>
</body>
</html>