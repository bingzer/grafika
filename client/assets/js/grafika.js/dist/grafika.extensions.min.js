Grafika.Plugins.push(function(a){var b=function(){function b(a){this.grafika=a,this.name="Extensions",this.version="1.0.0",this.imageQuality=100,this.frameRenderer=this.grafika.getRenderer("frame")}return b.prototype.clearFrame=function(){this.grafika.clear(),this.grafika.saveFrame()},b.prototype.deleteFrame=function(){var a=this.grafika.animation,b=a.currentFrame;0>b||(a.frames.splice(b,1),0==a.frames.length&&a.frames.push(this.frameRenderer.create()),b>a.frames.length-1&&(b=a.frames.length-1),a.currentFrame=b,this.grafika.frame=a.frames[a.currentFrame],this.grafika.navigateToFrame(a.currentFrame))},b.prototype.copyFrameToNext=function(){this.grafika.saveFrame();var a=this.grafika.getAnimation().currentFrame+1,b=JSON.parse(JSON.stringify(this.grafika.getFrame(),this.getJSONReplacer()));b.index=a,b.id=this.randomUid(),this.grafika.getAnimation().frames[a]=this.frameRenderer.create(b),this.grafika.navigateToFrame(a),this.log("Frame copied to next frame"),this.grafika.saveFrame()},b.prototype.copyFrameToPrevious=function(){this.grafika.saveFrame();var a=this.grafika.getAnimation().currentFrame-1;if(!(0>a)){var b=JSON.parse(JSON.stringify(this.grafika.getFrame(),this.getJSONReplacer()));b.index=a,b.id=this.randomUid(),this.grafika.getAnimation().frames[a]=this.frameRenderer.create(b),this.grafika.navigateToFrame(a),this.log("Frame copied to previous frame"),this.grafika.saveFrame()}},b.prototype.insertFrameAfter=function(){this.grafika.saveFrame();var a=this.grafika.animation.currentFrame,b=this.frameRenderer.create({index:a+1}),c=this.grafika.frame;this.grafika.animation.frames.splice(a,0,b),this.grafika.animation.frames[a]=c,this.grafika.animation.frames[b.index]=b,this.grafika.animation.currentFrame=b.index,this.grafika.frame=this.grafika.animation.frames[b.index],this.grafika.saveFrame(),this.grafika.navigateToFrame(this.grafika.animation.currentFrame),this.log("Frame inserted after current frame")},b.prototype.insertFrameBefore=function(){this.grafika.saveFrame();var a=this.grafika.animation.currentFrame;if(!(0>a)){var b=this.frameRenderer.create({index:a});this.grafika.animation.frames.splice(a,0,b),this.grafika.frame=this.grafika.animation.frames[a],this.grafika.saveFrame(),this.grafika.navigateToFrame(this.grafika.animation.currentFrame),this.log("Frame inserted before current frame")}},b.prototype.deleteSelectedGraphics=function(){this.grafika.deleteSelectedGraphics(),this.grafika.saveFrame(),this.log("Selected graphics deleted")},b.prototype.downloadAnimation=function(){this.grafika.saveFrame(),window.open("data:text/json;charset=utf-8,"+JSON.stringify(this.grafika.getAnimation(),this.getJSONReplacer()))},b.prototype.downloadFrameAsImage=function(){this.grafika.saveFrame(),window.open("data:image/png;base64,"+this.getCanvasData().base64)},b.prototype.getCanvasBlob=function(){for(var b=this.captureOldOptions(),c=atob(a.getCanvas().toDataURL("image/png",this.imageQuality).split(",")[1]),d=[],e=0;e<c.length;e++)d.push(c.charCodeAt(e));return a.setOptions(b),new Blob([new Uint8Array(d)],{type:"image/png"})},b.prototype.getCanvasData=function(){var b=this.captureOldOptions(),c=a.getCanvas().toDataURL("image/png",this.imageQuality),d=c.substring(c.indexOf("data:")+"data:".length,c.indexOf(";"));return a.setOptions(b),{mime:d,base64:c.substring(c.indexOf(",")+",".length)}},b.prototype.randomUid=function(){return("000000"+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6)},b.prototype.log=function(a){},b.prototype.captureOldOptions=function(){this.grafika.saveFrame();var a={useNavigationText:this.grafika.getOptions().useNavigationText,useCarbonCopy:this.grafika.getOptions().useCarbonCopy,drawingMode:this.grafika.getOptions().drawingMode};return this.grafika.setOptions({useNavigationText:!1,useCarbonCopy:!1,drawingMode:"none"}),a},b.prototype.getJSONReplacer=function(){return function(a,b){return"grafika"===a?void 0:b}},b}();return a.exts=new b(a)});
//# sourceMappingURL=grafika.js.map