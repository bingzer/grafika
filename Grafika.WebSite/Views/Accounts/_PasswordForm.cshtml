@model PasswordFormViewModel

<form class="form-horizontal" id="recovery-form" action="@Model.ApiPasswordUrl" method="post"
      data-callback="GrafikaApp.toast('Password is successfully set'); GrafikaApp.Dialog.close('#recovery-form')"
      onsubmit="return GrafikaApp.Form.onSubmit(this)">
    @if (Model.RequiresCurrentPassword)
    {
        <div class="form-group">
            <label class="control-label col-sm-4">
                Current Password
            </label>
            <div class="col-sm-8">
                <input class="form-control password" type="password" name="currPwd" placeholder="Current Password" required>
            </div>
        </div>
    }
    <div class="form-group">
        <label class="control-label col-sm-4">
            New Password
        </label>
        <div class="col-sm-8">
            <input id="pwd" class="form-control password" type="password" name="newPwd" placeholder="New Password" autocomplete="off">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-sm-4">
            Confirm Password
        </label>
        <div class="col-sm-8">
            <input id="pwd-confirm" class="form-control password" type="password" name="password" placeholder="Confirm Password" autocomplete="off">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-sm-4">
            &nbsp;
        </label>
        <div class="col-sm-8 text-right">
            <input id="submit" class="btn btn-primary" type="submit" value="Set Password" disabled="disabled"/>
        </div>
    </div>
</form>

<script type="text/javascript">
    function validatePassword() {
        var newPassword = $('#pwd').val();
        var confirmPassword = $('#pwd-confirm').val();
        return (newPassword && confirmPassword && newPassword === confirmPassword);
    }

    function validate() {
        if ($('#recovery-form').valid() && validatePassword())
            $('#submit').removeAttr('disabled');
        else $('#submit').attr('disabled', 'disabled');
    }

    $('.password').keyup(validate);
</script>

